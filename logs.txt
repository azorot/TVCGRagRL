(venv) [azoroth@theRottenCore new]$ python grag.py
2025-02-13 22:09:48,415 - matplotlib - DEBUG - wrapper:342 - matplotlib data path: /home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2025-02-13 22:09:48,420 - matplotlib - DEBUG - wrapper:342 - CONFIGDIR=/home/azoroth/.config/matplotlib
2025-02-13 22:09:48,421 - matplotlib - DEBUG - <module>:1557 - interactive is False
2025-02-13 22:09:48,421 - matplotlib - DEBUG - <module>:1558 - platform is linux
2025-02-13 22:09:48,476 - matplotlib - DEBUG - wrapper:342 - CACHEDIR=/home/azoroth/.cache/matplotlib
2025-02-13 22:09:48,625 - asyncio - DEBUG - __init__:64 - Using selector: EpollSelector
2025-02-13 22:09:48,625 - root - INFO - __init__:56 - VectorStoreHandler.__init__ called
2025-02-13 22:09:50,337 - sentence_transformers.SentenceTransformer - INFO - __init__:210 - Use pytorch device_name: cpu
2025-02-13 22:09:50,337 - sentence_transformers.SentenceTransformer - INFO - __init__:218 - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-02-13 22:09:51,905 - root - INFO - async_main:14 - grag.py: initalizing stores
2025-02-13 22:09:51,905 - root - INFO - initialize_stores:64 - VectorStoreHandler.initialize_stores called
2025-02-13 22:09:51,905 - root - INFO - initialize_doc_vectorstore:115 - VectorStoreHandler.initialize_doc_vectorstore called
2025-02-13 22:09:51,915 - chromadb.telemetry.product.posthog - INFO - __init__:22 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-02-13 22:09:52,399 - chromadb.config - DEBUG - start:337 - Starting component System
2025-02-13 22:09:52,400 - chromadb.config - DEBUG - start:337 - Starting component Posthog
2025-02-13 22:09:52,400 - chromadb.config - DEBUG - start:337 - Starting component OpenTelemetryClient
2025-02-13 22:09:52,400 - chromadb.config - DEBUG - start:337 - Starting component SqliteDB
2025-02-13 22:09:52,402 - chromadb.config - DEBUG - start:337 - Starting component SimpleQuotaEnforcer
2025-02-13 22:09:52,402 - chromadb.config - DEBUG - start:337 - Starting component SimpleRateLimitEnforcer
2025-02-13 22:09:52,402 - chromadb.config - DEBUG - start:337 - Starting component LocalSegmentManager
2025-02-13 22:09:52,402 - chromadb.config - DEBUG - start:337 - Starting component LocalExecutor
2025-02-13 22:09:52,403 - chromadb.config - DEBUG - start:337 - Starting component SegmentAPI
2025-02-13 22:09:52,406 - chromadb.api.segment - DEBUG - create_collection:259 - Collection rag-chroma already exists, returning existing collection.
2025-02-13 22:09:52,406 - root - INFO - initialize_doc_vectorstore:123 - Successfully loaded existing documentation vector store
2025-02-13 22:09:52,406 - root - INFO - initialize_stores:67 - doc_vectorstore successfully initalzied
2025-02-13 22:09:52,406 - root - INFO - initialize_code_vectorstore:81 - VectorStoreHandler.initialize_code_vectorstore called
2025-02-13 22:09:52,407 - chromadb.telemetry.product.posthog - INFO - __init__:22 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-02-13 22:09:52,408 - chromadb.config - DEBUG - start:337 - Starting component System
2025-02-13 22:09:52,409 - chromadb.config - DEBUG - start:337 - Starting component Posthog
2025-02-13 22:09:52,409 - chromadb.config - DEBUG - start:337 - Starting component OpenTelemetryClient
2025-02-13 22:09:52,409 - chromadb.config - DEBUG - start:337 - Starting component SqliteDB
2025-02-13 22:09:52,412 - chromadb.config - DEBUG - start:337 - Starting component SimpleQuotaEnforcer
2025-02-13 22:09:52,412 - chromadb.config - DEBUG - start:337 - Starting component SimpleRateLimitEnforcer
2025-02-13 22:09:52,413 - chromadb.config - DEBUG - start:337 - Starting component LocalSegmentManager
2025-02-13 22:09:52,413 - chromadb.config - DEBUG - start:337 - Starting component LocalExecutor
2025-02-13 22:09:52,413 - chromadb.config - DEBUG - start:337 - Starting component SegmentAPI
2025-02-13 22:09:52,416 - chromadb.api.segment - DEBUG - create_collection:259 - Collection generated-code already exists, returning existing collection.
2025-02-13 22:09:52,416 - root - INFO - initialize_code_vectorstore:89 - Successfully loaded existing code vector store
2025-02-13 22:09:52,416 - root - INFO - initialize_stores:69 - code_vectorestore successfully intialized
2025-02-13 22:09:52,417 - root - INFO - __init__:41 - EnhancedStrategyTester.__init__ called
2025-02-13 22:09:52,417 - sentence_transformers.SentenceTransformer - INFO - __init__:210 - Use pytorch device_name: cpu
2025-02-13 22:09:52,417 - sentence_transformers.SentenceTransformer - INFO - __init__:218 - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
Type of initial_batch_number: <class 'int'>, Value: 1
/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/gradio/components/chatbot.py:282: UserWarning: You have not specified a value for the `type` parameter. Defaulting to the 'tuples' format for chatbot messages, but this is deprecated and will be removed in a future version of Gradio. Please set type='messages' instead, which uses openai-style dictionaries with 'role' and 'content' keys.
  warnings.warn(
* Running on local URL:  http://0.0.0.0:8000

To create a public link, set `share=True` in `launch()`.
2025-02-13 22:09:59,838 - matplotlib.pyplot - DEBUG - switch_backend:497 - Loaded backend agg version v2.2.
2025-02-13 22:09:59,838 - root - INFO - initialize_rl_agent:30 - Initializing RL Agent with model: model='qwen2.5-coder:0.5b' base_url='http://127.0.0.1:11434', state_dim: 384, action_dim: 2, learning_rate: 0.001, batch_number: 1
2025-02-13 22:09:59,839 - root - INFO - __init__:232 - RLAgent.__init__ called
2025-02-13 22:09:59,839 - root - INFO - __init__:132 - PPOAlgorithm.__init__ called
2025-02-13 22:09:59,839 - root - INFO - __init__:68 - ActorNetwork.__init__ called
2025-02-13 22:09:59,841 - root - INFO - __init__:101 - CriticNetwork.__init__ called
2025-02-13 22:09:59,843 - root - INFO - __init__:31 - PPOMemory.__init__ called
2025-02-13 22:10:24,168 - root - INFO - sync_process_input:148 - Button 'Submit' clicked! Calling sync_process_input with question: Create a pinescript v6 indicator that uses ta.sma and ta.rsi and plot to the chart
2025-02-13 22:10:24,168 - root - INFO - sync_process_input:149 - sync_process_input - Input q type: <class 'str'>
2025-02-13 22:10:24,169 - root - INFO - process_input:34 - process_input called with question: Create a pinescript v6 indicator that uses ta.sma and ta.rsi and plot to the chart
2025-02-13 22:10:24,169 - root - INFO - process_input:35 - process_input - Input question type: <class 'str'>
2025-02-13 22:10:24,170 - root - INFO - ensure_stores_initialized:363 - VectorStoreHandler.ensure_stores_initialized called
2025-02-13 22:10:24,170 - root - INFO - are_stores_initialized:374 - VectorStoreHandler.are_stores_initialized called
2025-02-13 22:10:24,170 - root - INFO - are_stores_initialized:374 - VectorStoreHandler.are_stores_initialized called
Traceback (most recent call last):
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/gradio/queueing.py", line 625, in process_events
    response = await route_utils.call_process_api(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/gradio/route_utils.py", line 322, in call_process_api
    output = await app.get_blocks().process_api(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<11 lines>...
    )
    ^
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/gradio/blocks.py", line 2051, in process_api
    result = await self.call_function(
             ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<8 lines>...
    )
    ^
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/gradio/blocks.py", line 1598, in call_function
    prediction = await anyio.to_thread.run_sync(  # type: ignore
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        fn, *processed_input, limiter=self.limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 962, in run
    result = context.run(func, *args)
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/gradio/utils.py", line 883, in wrapper
    response = f(*args, **kwargs)
  File "/home/azoroth/projects/rag/ChatRag/GRADIO/new/gradio_interface.py", line 153, in sync_process_input
    return loop.run_until_complete(self.process_input(q, history))
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/azoroth/projects/rag/ChatRag/GRADIO/new/gradio_interface.py", line 49, in process_input
    docs = await doc_retriever.as_retriever(question, k=5)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/azoroth/projects/rag/ChatRag/venv/lib/python3.13/site-packages/pydantic/main.py", line 891, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'VectorStoreRetriever' object has no attribute 'as_retriever'
